---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

const base = import.meta.env.BASE_URL.endsWith("/")
  ? import.meta.env.BASE_URL
  : `${import.meta.env.BASE_URL}/`;

const peptides = await getCollection("peptides");

const sorted = peptides.sort((a, b) => {
  const ai = a.data.index ?? 9999;
  const bi = b.data.index ?? 9999;
  if (ai !== bi) return ai - bi;
  return a.data.name.localeCompare(b.data.name);
});
---

<BaseLayout title="Peptides â€¢ Peptipedia">
  <div class="prose">
    <h1>Peptides</h1>
    <p>Browse peptide entries and their key metadata.</p>
    <hr />
  </div>

  <div style="display:grid; gap:12px;">
    {sorted.map((p) => (
      <a
        class="card"
        href={`${base}peptides/${p.slug}`}
        style="padding:14px; display:block;"
      >
        <div style="font-weight:800; color:var(--text);">{p.data.name}</div>

        <div style="color:var(--muted); font-size:0.92rem; margin-top: 6px;">
          {p.data.classes?.length ? (
            <div>
              Classes: <span style="color:var(--text)">{p.data.classes.join(", ")}</span>
            </div>
          ) : null}

          {p.data.targets?.length ? (
            <div>
              Targets: <span style="color:var(--text)">{p.data.targets.join(", ")}</span>
            </div>
          ) : null}

          {p.data.evidence_floor ? (
            <div>
              Evidence floor: <span style="color:var(--text)">{p.data.evidence_floor}</span>
            </div>
          ) : null}

          {p.data.aliases?.length ? (
            <div style="margin-top:4px;">
              Aliases: <span style="color:var(--text)">{p.data.aliases.join(", ")}</span>
            </div>
          ) : null}
        </div>
      </a>
    ))}
  </div>
</BaseLayout>
