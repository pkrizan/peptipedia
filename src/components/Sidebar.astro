---
const nav = [
  { href: "/", label: "Home" },
  { href: "/peptides", label: "Peptides" },
  { href: "/classes", label: "Classes" },
  { href: "/targets", label: "Targets & Mechanisms" },
  { href: "/evidence", label: "Evidence levels" },
  { href: "/policy/editorial", label: "Editorial policy" },
  { href: "/policy/disclaimer", label: "Disclaimer" },
  { href: "/about", label: "About" },
];
---

<aside class="card" style="padding: 18px; position: sticky; top: 16px; height: fit-content;">
  <div style="display:flex; align-items:center; gap:10px; margin-bottom: 12px;">
    <div style="width:34px;height:34px;border-radius:12px;background:var(--primary);"></div>
    <div>
      <div style="font-weight:800; letter-spacing:-0.2px;">Peptipedia</div>
      <div style="font-size:0.86rem; color:var(--muted);">Scientific fandom for peptides</div>
    </div>
  </div>

  <div style="margin: 14px 0;">
    <input id="sidebarSearch" placeholder="Search peptides…" style="
      width:100%;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid var(--border);
      outline: none;
      font-size: 0.95rem;
    " />
    <div id="sidebarResults" style="margin-top:10px; display:none;"></div>
  </div>

  <nav style="display:flex; flex-direction:column; gap:6px;">
  {nav.map(item => (
    <a
      href={`${import.meta.env.BASE_URL.replace(/\/?$/, "/")}${item.href.replace(/^\//, "")}`}
      style="
        padding: 9px 10px;
        border-radius: 12px;
        border: 1px solid transparent;
        color: var(--text);
      "
    >
      {item.label}
    </a>
  ))}
</nav>


  <hr />

  <div style="font-size:0.85rem; color: var(--muted);">
    <b>v1</b> — Static, cited, evidence-graded.
  </div>

  <script>
    // Lightweight sidebar search (uses /search-index.json)
    const input = document.getElementById("sidebarSearch");
    const results = document.getElementById("sidebarResults");
    let index = null;

    async function loadIndex(){
      if(index) return index;
      const res = await fetch("/search-index.json");
      index = await res.json();
      return index;
    }

    function render(items){
      if(!items.length){
        results.style.display = "block";
        results.innerHTML = `<div style="color: var(--muted); font-size:0.9rem;">No results</div>`;
        return;
      }
      results.style.display = "block";
      results.innerHTML = items.slice(0,6).map(x => `
        <a href="${x.url}" style="display:block; padding:8px 10px; border-radius:12px; border:1px solid var(--border); margin-bottom:6px;">
          <div style="font-weight:700; color: var(--text);">${x.name}</div>
          <div style="font-size:0.85rem; color: var(--muted);">${(x.classes||[]).join(", ")}</div>
        </a>
      `).join("");
    }

    input?.addEventListener("input", async (e) => {
      const q = (e.target.value || "").trim().toLowerCase();
      if(q.length < 2){ results.style.display="none"; return; }
      const idx = await loadIndex();
      const hits = idx.filter(x => {
        const hay = (x.name + " " + (x.aliases||[]).join(" ")).toLowerCase();
        return hay.includes(q);
      });
      render(hits);
    });
  </script>
</aside>
